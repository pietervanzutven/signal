(function () {
    'use_strict';

    window.node_fetch = (url, options) => {
        if (!options.body) {
            delete options.body;
        }

        if (options.headers['User-Agent']) {
            delete options.headers['User-Agent'];
        }

        return window.fetch(url, options)
            .then(response => {
                response.buffer = () => response.arrayBuffer().then(result => Buffer.from(result));
                response.textConverted = response.text;
                return response;
            });
    }

})();