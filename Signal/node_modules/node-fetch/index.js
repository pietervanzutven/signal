(function () {
    'use_strict';

    window.node_fetch = async (url, options) => {
        if (!options.body) {
            delete options.body;
        }

        if (options.headers['User-Agent']) {
            delete options.headers['User-Agent'];
        }

        const response = await window.fetch(url, options);

        response.buffer = async () => {
            const buffer = await response.arrayBuffer();
            return Buffer.from(buffer);
        }
        response.textConverted = async () => {
            const text = await response.text();
            return text;
        }

        return response;
    }

})();