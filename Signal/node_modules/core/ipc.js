(function () {
    'use strict';

    window.ipc = {
        events: {},
        on: function (channel, listener) {
            ipc.events[channel] = listener;
        },

        once: function (channel, listener) {
            ipc.events[channel] = function () {
                listener.apply(null, arguments);
                delete ipc.events[channel];
            }
        },
        send: function () {
            let args = Array.prototype.slice.call(arguments, 0);
            const channel = args[0];
            const event = { channel: channel, returnValue: null, sender: { send: ipc.send } };
            args[0] = event;
            ipc.events[channel].apply(null, args);
            return event.returnValue;
        },
        sendSync: function () {
            return ipc.send.apply(null, arguments);
        },
        setMaxListeners: function () { }
    }

    window.ipc.ipcRenderer = window.ipc;
    window.ipc.ipcMain = window.ipc;
})();